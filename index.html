<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>T&M Arte Virtual - Criação de Imagens AI</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>

        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .glass-effect {
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
    </style>
</head>
<body class="bg-gray-900 text-white">
    <!-- Header -->
    <header class="gradient-bg shadow-lg sticky top-0 z-50">
        <div class="container mx-auto px-4 py-3 flex items-center justify-between">
            <div class="flex items-center space-x-3">
                <img src="pMvG5cSdQxStbTTMi53PG" alt="T&M Arte Virtual" class="h-12 w-12 rounded-full">
                <h1 class="text-2xl font-bold">T&M Arte Virtual</h1>
            </div>
            <nav class="hidden md:flex space-x-6">
                <button onclick="showTab('generator')" class="hover:text-yellow-300 transition-colors">Gerador</button>
                <button onclick="showTab('veo3')" class="hover:text-yellow-300 transition-colors">VEO3</button>
                <button onclick="showPix()" class="bg-green-600 px-4 py-2 rounded-lg hover:bg-green-700 transition-colors">
                    <i class="fas fa-donate mr-2"></i>PIX
                </button>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <!-- Generator Tab -->
        <div id="generator-tab" class="tab-content">
            <div class="grid lg:grid-cols-3 gap-8">
                <!-- Controls Panel -->
                <div class="lg:col-span-1">
                    <div class="glass-effect rounded-xl p-6">
                        <h2 class="text-xl font-bold mb-4">Controles de Geração</h2>
                        
                        <!-- Prompt Input -->
                        <div class="mb-4">
                            <label class="block mb-2">Prompt:</label>
                            <textarea id="prompt" placeholder="Descreva a imagem que você quer criar..." 
                                    class="w-full p-3 rounded-lg bg-gray-800 text-white border border-gray-600 focus:border-blue-500 h-24"></textarea>
                            <div class="mt-2 flex space-x-2">
                                <button onclick="enhancePromptInGenerator()" class="flex-1 bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors">
                                    <i class="fas fa-magic mr-2"></i>Melhorar
                                </button>
                                <select id="translateLang" class="bg-gray-800 text-white px-3 py-2 rounded-lg border border-gray-600">
                                    <option value="">Traduzir para...</option>
                                    <option value="en">Inglês</option>
                                    <option value="es">Espanhol</option>
                                    <option value="fr">Francês</option>
                                    <option value="it">Italiano</option>
                                    <option value="de">Alemão</option>
                                    <option value="ja">Japonês</option>
                                    <option value="ko">Coreano</option>
                                    <option value="zh">Chinês</option>
                                </select>
                                <button onclick="translatePromptInGenerator()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                                    <i class="fas fa-language mr-2"></i>Traduzir
                                </button>
                            </div>
                        </div>

                        <!-- Style Categories -->
                        <div class="mb-4">
                            <label class="block mb-2">Estilo:</label>
                            <select id="style" class="w-full p-3 rounded-lg bg-gray-800 text-white border border-gray-600">
                                <option value="">Selecione um estilo</option>
                                <optgroup label="Realista">
                                    <option value="photorealistic">Fotorrealista</option>
                                    <option value="portrait">Retrato</option>
                                    <option value="landscape">Paisagem</option>
                                </optgroup>
                                <optgroup label="Religioso">
                                    <option value="religious-art">Arte Religiosa</option>
                                    <option value="biblical">Bíblico</option>
                                    <option value="sacred">Sagrado</option>
                                </optgroup>
                                <optgroup label="Terror">
                                    <option value="horror">Terror</option>
                                    <option value="dark-fantasy">Fantasia Sombria</option>
                                    <option value="gothic">Gótico</option>
                                </optgroup>
                                <optgroup label="Romance">
                                    <option value="romantic">Romântico</option>
                                    <option value="wedding">Casamento</option>
                                    <option value="love">Amor</option>
                                </optgroup>
                                <optgroup label="Ficção">
                                    <option value="sci-fi">Ficção Científica</option>
                                    <option value="fantasy">Fantasia</option>
                                    <option value="cyberpunk">Cyberpunk</option>
                                </optgroup>
                                <optgroup label="Para Colorir">
                                    <option value="coloring-book">Livro de Colorir</option>
                                    <option value="line-art">Arte Linear</option>
                                    <option value="mandala">Mandala</option>
                                </optgroup>
                                <optgroup label="Anime">
                                    <option value="anime">Anime</option>
                                    <option value="manga">Manga</option>
                                    <option value="chibi">Chibi</option>
                                </optgroup>
                            </select>
                        </div>

                        <!-- Image Size -->
                        <div class="mb-4">
                            <label class="block mb-2">Tamanho da Imagem:</label>
                            <select id="size" class="w-full p-3 rounded-lg bg-gray-800 text-white border border-gray-600">
                                <option value="512x512">Quadrado (512x512)</option>
                                <option value="768x512">Paisagem (768x512)</option>
                                <option value="512x768">Retrato (512x768)</option>
                                <option value="1024x1024">Grande Quadrado (1024x1024)</option>
                                <option value="1024x768">Grande Paisagem (1024x768)</option>
                                <option value="768x1024">Grande Retrato (768x1024)</option>
                            </select>
                        </div>

                        <!-- Number of Images -->
                        <div class="mb-4">
                            <label class="block mb-2">Número de Imagens (1-30):</label>
                            <input type="range" id="numImages" min="1" max="30" value="4" 
                                   class="w-full" onchange="document.getElementById('numDisplay').textContent = this.value">
                            <div class="text-center mt-1">
                                <span id="numDisplay">4</span> imagens
                            </div>
                        </div>

                        <!-- Generate Button -->
                        <button onclick="generateImages()" 
                                class="w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 
                                       py-3 rounded-lg font-semibold transition-all transform hover:scale-105">
                            <i class="fas fa-magic mr-2"></i>Gerar Imagens
                        </button>
                    </div>
                </div>

                <!-- Generated Images -->
                <div class="lg:col-span-2">
                    <div class="glass-effect rounded-xl p-6">
                        <h2 class="text-xl font-bold mb-4">Imagens Geradas</h2>
                        <div id="imageGrid" class="grid grid-cols-2 md:grid-cols-3 gap-4 min-h-[400px]">
                            <div class="col-span-full flex items-center justify-center text-gray-400">
                                <i class="fas fa-image text-6xl mb-4"></i>
                                <p class="text-center">Suas imagens aparecerão aqui após a geração</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- VEO3 Tab -->
        <div id="veo3-tab" class="tab-content hidden">
            <div class="glass-effect rounded-xl p-8 text-center">
                <h2 class="text-3xl font-bold mb-6">VEO3 - Geração de Vídeo AI</h2>
                <div class="bg-yellow-600 text-black p-4 rounded-lg mb-6">
                    <i class="fas fa-exclamation-triangle mr-2"></i>
                    <strong>Atenção:</strong> É necessário usar VPN com IP dos Estados Unidos para acessar o VEO3
                </div>
                <p class="text-xl mb-6">Acesse a tecnologia mais avançada de geração de vídeos por IA</p>
                <button onclick="openVeo3()" 
                        class="bg-red-600 hover:bg-red-700 px-8 py-4 rounded-lg text-xl font-bold transition-all transform hover:scale-105">
                    <i class="fas fa-external-link-alt mr-2"></i>Abrir VEO3
                </button>
            </div>
        </div>




    </main>

    <!-- PIX Modal -->
    <div id="pixModal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white text-black rounded-xl p-8 max-w-md mx-4">
            <div class="text-center">
                <h3 class="text-2xl font-bold mb-4">Apoie o T&M Arte Virtual</h3>
                <p class="mb-6">Ajude a manter o site sempre atualizado e online com novas funcionalidades!</p>
                
                <div class="bg-gray-100 p-4 rounded-lg mb-4">
                    <p class="font-bold">Chave PIX:</p>
                    <p class="text-lg font-mono bg-gray-200 p-2 rounded" id="pixKey">84996096315</p>
                    <p class="text-sm mt-2">Tancredo Oliveira - Banco Neon</p>
                </div>
                
                <div class="flex space-x-4">
                    <button onclick="copyPix()" class="bg-green-600 text-white px-4 py-2 rounded-lg flex-1">
                        <i class="fas fa-copy mr-2"></i>Copiar PIX
                    </button>
                    <button onclick="closePix()" class="bg-gray-600 text-white px-4 py-2 rounded-lg flex-1">
                        Fechar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        // Tab Management
        window.showTab = function(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.add('hidden'));
            document.getElementById(tabName + '-tab').classList.remove('hidden');
        }

        // PIX Modal
        window.showPix = function() {
            document.getElementById('pixModal').classList.remove('hidden');
        }

        window.closePix = function() {
            document.getElementById('pixModal').classList.add('hidden');
        }

        window.copyPix = function() {
            navigator.clipboard.writeText('84996096315').then(() => {
                alert('Chave PIX copiada com sucesso!');
            });
        }

        // VEO3 Access
        window.openVeo3 = function() {
            window.open('https://opal.withgoogle.com/?flow=drive:/1M1RZ5CqMRsP2Ys6JArbYZt0WyUq6AbnE&mode=app&shared=true', '_blank');
        }
        

        // Image Generation
        window.generateImages = function() {
            const prompt = document.getElementById('prompt').value;
            const style = document.getElementById('style').value;
            const size = document.getElementById('size').value;
            const numImages = parseInt(document.getElementById('numImages').value);

            if (!prompt.trim()) {
                alert('Por favor, insira um prompt para gerar as imagens.');
                return;
            }

            const imageGrid = document.getElementById('imageGrid');
            imageGrid.innerHTML = '<div class="col-span-full text-center"><i class="fas fa-spinner fa-spin text-4xl mb-4"></i><p>Gerando imagens...</p></div>';

            // Generate unique images with proper style application
            setTimeout(() => {
                let html = '';
                const timestamp = Date.now();
                
                for (let i = 0; i < numImages; i++) {
                    // Create unique prompt with style modifiers
                    let fullPrompt = prompt;
                    
                    // Apply style modifiers
                    if (style) {
                        const styleModifiers = {
                            'photorealistic': 'photorealistic, ultra realistic, 8k, professional photography',
                            'portrait': 'professional portrait photography, studio lighting, detailed face',
                            'landscape': 'landscape photography, scenic view, natural lighting',
                            'religious-art': 'religious art, sacred, spiritual, renaissance style',
                            'biblical': 'biblical scene, classical religious painting, divine lighting',
                            'sacred': 'sacred art, holy, ethereal, golden light',
                            'horror': 'horror style, dark, scary, gothic atmosphere',
                            'dark-fantasy': 'dark fantasy art, mysterious, shadows, dramatic',
                            'gothic': 'gothic style, dark architecture, medieval atmosphere',
                            'romantic': 'romantic style, soft lighting, pastel colors, dreamy',
                            'wedding': 'wedding photography, elegant, beautiful, celebration',
                            'love': 'romantic scene, love, tender moment, soft focus',
                            'sci-fi': 'science fiction, futuristic, high tech, space age',
                            'fantasy': 'fantasy art, magical, enchanted, mystical creatures',
                            'cyberpunk': 'cyberpunk style, neon lights, futuristic city, digital',
                            'coloring-book': 'coloring book style, black and white line art, simple',
                            'line-art': 'line art, minimalist, clean lines, black and white',
                            'mandala': 'mandala design, geometric patterns, symmetrical, intricate',
                            'anime': 'anime style, manga art, japanese animation, colorful',
                            'manga': 'manga style, black and white, japanese comic art',
                            'chibi': 'chibi style, cute, small characters, kawaii'
                        };
                        
                        if (styleModifiers[style]) {
                            fullPrompt += ', ' + styleModifiers[style];
                        }
                    }
                    
                    // Add variation to each image
                    const variations = [
                        ', high quality, detailed',
                        ', masterpiece, artistic',
                        ', professional, clean',
                        ', vibrant colors, sharp',
                        ', dramatic lighting',
                        ', soft focus, elegant',
                        ', dynamic composition',
                        ', rich textures, depth'
                    ];
                    
                    const variation = variations[i % variations.length];
                    const uniqueId = `${timestamp}_${i}_${Math.random().toString(36).substr(2, 9)}`;
                    const sizeParam = `&size=${size}`;
                    const encodedPrompt = encodeURIComponent(fullPrompt + variation);
                    
                    // Calculate dimensions based on selected size
                    const [width, height] = size.split('x').map(Number);
                    const aspectRatio = width / height;
                    
                    // Generate proper aspect ratio URL parameter
                    let aspectParam = '';
                    if (width === height) {
                        aspectParam = '&aspect=1:1';
                    } else if (aspectRatio > 1) {
                        // Landscape
                        const ratio = Math.round(aspectRatio * 100) / 100;
                        if (ratio >= 1.77) aspectParam = '&aspect=16:9';
                        else if (ratio >= 1.4) aspectParam = '&aspect=3:2';
                        else aspectParam = '&aspect=4:3';
                    } else {
                        // Portrait
                        const ratio = Math.round((height / width) * 100) / 100;
                        if (ratio >= 1.77) aspectParam = '&aspect=9:16';
                        else if (ratio >= 1.4) aspectParam = '&aspect=2:3';
                        else aspectParam = '&aspect=3:4';
                    }
                    
                    const imageUrl = `keys/${uniqueId}?prompt=${encodedPrompt}${sizeParam}${aspectParam}`;
                    const safePrompt = fullPrompt.replace(/'/g, '&#39;').replace(/"/g, '&quot;');
                    
                    html += `
                        <div class="relative group">
                            <div class="w-full bg-gray-800 rounded-lg overflow-hidden" style="aspect-ratio: ${width}/${height};">
                                <img src="${imageUrl}" 
                                     alt="Generated Image ${i+1}" 
                                     class="w-full h-full object-cover cursor-pointer"
                                     onclick="viewImage('${imageUrl}', '${safePrompt}', '${width}x${height}')">
                            </div>
                            <div class="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 transition-all rounded-lg flex items-center justify-center">
                                <div class="flex space-x-2">
                                    <button onclick="event.stopPropagation(); viewImage('${imageUrl}', '${safePrompt}', '${width}x${height}')" 
                                            class="bg-green-600 text-white px-3 py-2 rounded-lg opacity-0 group-hover:opacity-100 transition-all">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button onclick="event.stopPropagation(); downloadImage('${imageUrl}', '${uniqueId}')" 
                                            class="bg-blue-600 text-white px-3 py-2 rounded-lg opacity-0 group-hover:opacity-100 transition-all">
                                        <i class="fas fa-download"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
                }
                imageGrid.innerHTML = html;
            }, 2000);
        }

        window.downloadImage = function(src, filename = null) {
            const downloadName = filename ? `tm_arte_virtual_${filename}.png` : `tm_arte_virtual_${Date.now()}.png`;
            
            // Create a temporary canvas to handle the image
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            const img = new Image();
            
            img.crossOrigin = 'anonymous';
            img.onload = function() {
                canvas.width = img.width;
                canvas.height = img.height;
                ctx.drawImage(img, 0, 0);
                
                canvas.toBlob(function(blob) {
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = downloadName;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    window.URL.revokeObjectURL(url);
                }, 'image/png');
            };
            
            img.onerror = function() {
                // Fallback: direct link download
                const a = document.createElement('a');
                a.href = src;
                a.download = downloadName;
                a.target = '_blank';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
            };
            
            img.src = src;
        }

        window.viewImage = function(src, prompt, dimensions = null) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50 p-4';
            modal.onclick = function(e) {
                if (e.target === modal) modal.remove();
            };
            
            modal.innerHTML = `
                <div class="max-w-6xl max-h-[95vh] bg-white rounded-lg overflow-hidden shadow-2xl">
                    <div class="bg-gray-800 text-white p-4 flex justify-between items-center">
                        <h3 class="font-bold text-lg">Visualizar Imagem Gerada</h3>
                        <button onclick="this.closest('.fixed').remove()" class="text-white hover:text-red-400 text-xl">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="p-6">
                        <div class="flex justify-center mb-4">
                            <div class="max-w-full max-h-[70vh] bg-gray-100 rounded-lg shadow-lg overflow-hidden">
                                <img src="${src}" alt="Generated Image" class="w-full h-full object-contain" 
                                     onload="this.style.opacity='1'" style="opacity:0; transition: opacity 0.3s;">
                            </div>
                        </div>
                        <div class="mt-4 p-4 bg-gray-50 rounded-lg">
                            <p class="text-sm text-gray-700"><strong>Prompt usado:</strong></p>
                            <p class="text-sm text-gray-600 mt-1 italic">${prompt}</p>
                            ${dimensions ? `<p class="text-sm text-gray-500 mt-2"><strong>Dimensões:</strong> ${dimensions}</p>` : ''}
                        </div>
                        <div class="mt-6 flex justify-center space-x-4">
                            <button onclick="downloadImage('${src}', 'imagem_${Date.now()}')" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors flex items-center">
                                <i class="fas fa-download mr-2"></i>Baixar Imagem
                            </button>
                            <button onclick="this.closest('.fixed').remove()" class="bg-gray-600 text-white px-6 py-3 rounded-lg hover:bg-gray-700 transition-colors">
                                <i class="fas fa-times mr-2"></i>Fechar
                            </button>
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        
        // Enhance prompt in generator tab
        window.enhancePromptInGenerator = function() {
            const originalPrompt = document.getElementById('prompt').value;
            
            if (!originalPrompt.trim()) {
                alert('Por favor, digite um prompt primeiro.');
                return;
            }

            const enhancements = [
                ', highly detailed, 8k resolution, professional photography, masterpiece',
                ', cinematic lighting, ultra realistic, award winning, high quality',
                ', vibrant colors, sharp focus, perfect composition, stunning details',
                ', dramatic lighting, photorealistic, studio quality, intricate details',
                ', premium quality, perfect lighting, rich textures, depth of field',
                ', professional grade, exceptional detail, perfect clarity, artistic masterpiece',
                ', ultra high definition, flawless execution, museum quality, breathtaking',
                ', crystal clear, perfect proportions, excellent composition, world class'
            ];

            const randomEnhancement = enhancements[Math.floor(Math.random() * enhancements.length)];
            const enhanced = originalPrompt + randomEnhancement;
            
            document.getElementById('prompt').value = enhanced;
            
            // Show feedback
            const button = event.target;
            const originalText = button.innerHTML;
            button.innerHTML = '<i class="fas fa-check mr-2"></i>Prompt Melhorado!';
            button.classList.remove('bg-purple-600', 'hover:bg-purple-700');
            button.classList.add('bg-green-600');
            
            setTimeout(() => {
                button.innerHTML = originalText;
                button.classList.remove('bg-green-600');
                button.classList.add('bg-purple-600', 'hover:bg-purple-700');
            }, 2000);
        }
        
        // Translate prompt in generator tab
        window.translatePromptInGenerator = function() {
            const originalPrompt = document.getElementById('prompt').value;
            const toLang = document.getElementById('translateLang').value;
            
            if (!originalPrompt.trim()) {
                alert('Por favor, digite um prompt primeiro.');
                return;
            }
            
            if (!toLang) {
                alert('Por favor, selecione um idioma para tradução.');
                return;
            }
            
            const button = event.target;
            const originalText = button.innerHTML;
            button.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Traduzindo...';
            button.disabled = true;
            
            // Use MyMemory translation API
            const url = `https://api.mymemory.translated.net/get?q=${encodeURIComponent(originalPrompt)}&langpair=pt|${toLang}`;
            
            fetch(url)
                .then(response => response.json())
                .then(data => {
                    if (data.responseStatus === 200 || data.responseData) {
                        document.getElementById('prompt').value = data.responseData.translatedText;
                        button.innerHTML = '<i class="fas fa-check mr-2"></i>Traduzido!';
                        button.classList.remove('bg-blue-600', 'hover:bg-blue-700');
                        button.classList.add('bg-green-600');
                    } else {
                        throw new Error('Translation failed');
                    }
                })
                .catch(error => {
                    console.error('Translation error:', error);
                    // Basic fallback translations
                    const basicTranslations = {
                        'en': {
                            'gato': 'cat', 'cachorro': 'dog', 'casa': 'house', 'carro': 'car',
                            'paisagem': 'landscape', 'retrato': 'portrait', 'bonito': 'beautiful',
                            'mulher': 'woman', 'homem': 'man', 'criança': 'child'
                        },
                        'es': {
                            'gato': 'gato', 'cachorro': 'perro', 'casa': 'casa', 'carro': 'coche',
                            'paisagem': 'paisaje', 'retrato': 'retrato', 'bonito': 'hermoso'
                        },
                        'fr': {
                            'gato': 'chat', 'cachorro': 'chien', 'casa': 'maison', 'carro': 'voiture',
                            'paisagem': 'paysage', 'retrato': 'portrait', 'bonito': 'beau'
                        }
                    };
                    
                    const words = originalPrompt.toLowerCase().split(' ');
                    const translated = words.map(word => {
                        return basicTranslations[toLang] && basicTranslations[toLang][word] 
                            ? basicTranslations[toLang][word] 
                            : word;
                    }).join(' ');
                    
                    document.getElementById('prompt').value = translated;
                    button.innerHTML = '<i class="fas fa-check mr-2"></i>Traduzido!';
                    button.classList.remove('bg-blue-600', 'hover:bg-blue-700');
                    button.classList.add('bg-green-600');
                })
                .finally(() => {
                    button.disabled = false;
                    setTimeout(() => {
                        button.innerHTML = originalText;
                        button.classList.remove('bg-green-600');
                        button.classList.add('bg-blue-600', 'hover:bg-blue-700');
                    }, 2000);
                });
        }
    </script>
</body>
</html>
